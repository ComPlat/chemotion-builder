Sending build context to Docker daemon     98MB
Step 1/31 : ARG BASE=chemotion-build/base:1.4.0
Step 2/31 : ARG SPECTRA_BUILD_TAG=0.10.15
Step 3/31 : ARG SPECTRA_VERSION=1.4.0
Step 4/31 : ARG BUILDRUN
Step 5/31 : ARG MSC_PORT=8088
Step 6/31 : ARG SPECTRA_PORT=3007
Step 7/31 : FROM ${BASE} as spectra-builder
 ---> ddd79c08c9e5
Step 8/31 : RUN apt-get install -y --no-install-recommends git ca-certificates curl
 ---> Using cache
 ---> a55b046f9f8a
Step 9/31 : RUN mkdir -p    /builder/tmp &&     curl -L -o  /builder/tmp/conda.sh https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh &&     chmod +x    /builder/tmp/conda.sh
 ---> Using cache
 ---> 473c64c25171
Step 10/31 : ARG SPECTRA_BUILD_TAG
 ---> Using cache
 ---> 782668746d7b
Step 11/31 : RUN mkdir -p /builder/app && cd /builder/app &&     git init --initial-branch=main . &&     git remote add origin https://github.com/ComPlat/chem-spectra-app &&     git fetch --tags --depth 1 origin ${SPECTRA_BUILD_TAG} &&     git reset --hard FETCH_HEAD &&     rm -rf .git
 ---> Using cache
 ---> e1975022d453
Step 12/31 : ADD ./environment.yml        /builder/app/environment.yml
 ---> Using cache
 ---> 421a9aa96631
Step 13/31 : ADD ./spectra_config.py      /builder/app/instance/config.py
 ---> Using cache
 ---> 6a49c62089e2
Step 14/31 : ADD ./scripts/fake-docker.py /builder/bin/docker
 ---> Using cache
 ---> eff171723f73
Step 15/31 : ADD ./scripts/mscrunner.py   /builder/bin/mscrunner.py
 ---> Using cache
 ---> e35c7de5ff59
Step 16/31 : RUN chmod +x /builder/bin/docker
 ---> Using cache
 ---> 2e28ffb8ee84
Step 17/31 : FROM ${BASE} as spectra
 ---> ddd79c08c9e5
Step 18/31 : RUN apt-get install -y --no-install-recommends git ca-certificates curl
 ---> Using cache
 ---> a55b046f9f8a
Step 19/31 : RUN apt-get install -y --no-install-recommends     gcc g++ libxrender1 libxext-dev pkg-config     libfreetype6-dev # for matplotlib
 ---> Using cache
 ---> d01cd7141ff5
Step 20/31 : ARG SPECTRA_PORT
 ---> Using cache
 ---> 366ff99dcf79
Step 21/31 : COPY --from=spectra-builder /builder /builder
 ---> Using cache
 ---> 9073b00705a0
Step 22/31 : RUN mv /builder/bin/docker /bin/docker &&     mv /builder/app/ / &&     mv /builder/tmp/ / &&     rm -rf /builder
 ---> Using cache
 ---> 891adfb78ce3
Step 23/31 : RUN bash /tmp/conda.sh -p /anaconda3 -b && rm /tmp/conda.sh &&     echo "PATH=/anaconda3/condabin/:$PATH" >> ~/.profile &&     /anaconda3/condabin/conda update -y -n base -c defaults conda &&     /anaconda3/condabin/conda env create -f /app/environment.yml &&     /anaconda3/condabin/conda install -c anaconda -n chem-spectra setuptools==58.0.4
 ---> Using cache
 ---> 37f603b71150
Step 24/31 : SHELL ["/anaconda3/condabin/conda", "run", "--no-capture-output", "-n", "chem-spectra", "/bin/bash", "-c"]
 ---> Using cache
 ---> f64b26dd4535
Step 25/31 : RUN cd /app &&     mkdir -p /shared /app/instance &&     ln -s /shared /app/chem_spectra/tmp &&     pip install -r requirements.txt
 ---> Using cache
 ---> d128d449ad37
Step 26/31 : EXPOSE ${SPECTRA_PORT}
 ---> Using cache
 ---> 328de5afee4a
Step 27/31 : ENV FLASK_ENV=production     FLASK_DEBUG=0     MSC_HOST=msconvert     MSC_PORT=${MSC_PORT}     MSC_VALIDATE=true     SPECTRA_PORT=${SPECTRA_PORT}
 ---> Using cache
 ---> b8220fbd3df3
Step 28/31 : WORKDIR /app
 ---> Using cache
 ---> 30d01ab88aa3
Step 29/31 : ENTRYPOINT ["/tini", "--", "/anaconda3/condabin/conda", "run", "--no-capture-output", "-n", "chem-spectra"]
 ---> Using cache
 ---> eca58a68e531
Step 30/31 : CMD gunicorn -w 4 -b 0.0.0.0:${SPECTRA_PORT} server:app
 ---> Using cache
 ---> 3b94e5137392
Step 31/31 : HEALTHCHECK --interval=5s --timeout=3s --start-period=30s --retries=3     CMD curl --fail http://localhost:${SPECTRA_PORT}/ping || exit 1
 ---> Using cache
 ---> 9367f587bfd3
Successfully built 9367f587bfd3
Successfully tagged chemotion-build/spectra:1.4.0
